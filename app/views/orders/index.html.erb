<% content_for :title, "My Orders" %>

<!-- Header -->
<div class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-8 gap-4">
  <div>
    <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">
      My Orders
    </h1>
    <p class="text-sm opacity-70">Track pork/chicken, delivery, and status</p>
  </div>

  <div class="flex gap-2">
    <%= link_to new_order_path, class: "btn btn-primary gap-2 shadow-lg hover:shadow-xl transition-all hover:scale-105" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
      </svg>
      New Order
    <% end %>
  </div>
</div>

<!-- Summary Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
  <div class="stat bg-base-100 rounded-2xl shadow-lg hover:shadow-xl transition-all hover:scale-105 border border-base-300">
    <div class="stat-figure text-primary">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
      </svg>
    </div>
    <div class="stat-title text-base-content/70">Total Bags</div>
    <div class="stat-value text-primary"><%= @total_bags %></div>
    <div class="stat-desc">All orders combined</div>
  </div>

  <div class="stat bg-base-100 rounded-2xl shadow-lg hover:shadow-xl transition-all hover:scale-105 border border-base-300">
    <div class="stat-figure text-secondary">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
    </div>
    <div class="stat-title text-base-content/70">Pork</div>
    <div class="stat-value text-secondary"><%= @total_pork %></div>
    <div class="stat-desc">Pork bags</div>
  </div>

  <div class="stat bg-base-100 rounded-2xl shadow-lg hover:shadow-xl transition-all hover:scale-105 border border-base-300">
    <div class="stat-figure text-accent">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
    </div>
    <div class="stat-title text-base-content/70">Chicken</div>
    <div class="stat-value text-accent"><%= @total_chicken %></div>
    <div class="stat-desc">Chicken bags</div>
  </div>

  <div class="stat bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl shadow-lg hover:shadow-xl transition-all hover:scale-105 border border-primary/20">
    <div class="stat-figure text-primary">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-8 h-8 stroke-current">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
    </div>
    <div class="stat-title text-base-content/70">Total Cost</div>
    <div class="stat-value text-primary">
      <%= number_to_currency(@total_cost, unit: "‡∏ø", precision: 0) %>
    </div>
    <div class="stat-desc">Revenue</div>
  </div>
</div>

<!-- Orders Table -->
<% if @orders.any? %>
  <div class="card bg-base-100 shadow-xl border border-base-300">
    <div class="card-body p-0">
      <div class="overflow-x-auto">
        <table class="table table-zebra">
          <thead>
            <tr class="bg-base-200">
              <th class="font-semibold">Date</th>
              <th class="font-semibold">Customer</th>
              <th class="text-right font-semibold">Pork</th>
              <th class="text-right font-semibold">Chicken</th>
              <th class="text-right font-semibold">Order</th>
              <th class="text-right font-semibold">Delivery</th>
              <th class="text-right font-semibold">Total</th>
              <th class="font-semibold">Channel</th>
              <th class="font-semibold">Status</th>
              <th class="font-semibold">Actions</th>
            </tr>
          </thead>

          <tbody>
            <% @orders.each do |order| %>
              <tr class="hover:bg-base-200/50 transition-colors">
                <td>
                  <div class="font-medium"><%= order.order_date || "‚Äî" %></div>
                </td>

                <td>
                  <div class="font-semibold text-base"><%= order.customer_name %></div>
                  <% if order.customer_address.present? %>
                    <div class="text-xs opacity-60 mt-1">
                      <%= truncate(order.customer_address, length: 40) %>
                    </div>
                  <% end %>
                </td>

                <td class="text-right">
                  <span class="badge badge-secondary badge-lg"><%= order.pork_qty.to_i %></span>
                </td>
                <td class="text-right">
                  <span class="badge badge-accent badge-lg"><%= order.chicken_qty.to_i %></span>
                </td>

                <td class="text-right font-medium">
                  <%= number_to_currency(order.order_cost, unit: "‡∏ø", precision: 0) %>
                </td>

                <td class="text-right font-medium">
                  <%= number_to_currency(order.delivery_cost, unit: "‡∏ø", precision: 0) %>
                </td>

                <td class="text-right">
                  <div class="font-bold text-lg text-primary">
                    <%= number_to_currency(order.total_cost, unit: "‡∏ø", precision: 0) %>
                  </div>
                </td>

                <td>
                  <% if order.delivery_channel.present? %>
                    <span class="badge badge-outline"><%= order.delivery_channel %></span>
                  <% else %>
                    <span class="text-base-content/40">‚Äî</span>
                  <% end %>
                </td>

                <td>
                  <% case order.status %>
                  <% when "Done" %>
                    <span class="badge badge-success badge-lg gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                      </svg>
                      Done
                    </span>
                  <% when "Packing" %>
                    <span class="badge badge-warning badge-lg gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                      Packing
                    </span>
                  <% when "Cancelled" %>
                    <span class="badge badge-error badge-lg gap-2">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                      </svg>
                      Cancelled
                    </span>
                  <% else %>
                    <span class="badge badge-ghost">‚Äî</span>
                  <% end %>
                </td>

                <td>
                  <div class="flex gap-2 justify-end">
                    <%= link_to edit_order_path(order), class: "btn btn-ghost btn-xs gap-1 hover:btn-primary transition-all" do %>
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                      </svg>
                      Edit
                    <% end %>
                    <%= link_to order_path(order), class: "btn btn-ghost btn-xs gap-1 hover:btn-info transition-all" do %>
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                      </svg>
                      View
                    <% end %>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% else %>
  <div class="card bg-base-100 shadow-xl border border-base-300">
    <div class="card-body text-center py-16">
      <div class="text-6xl mb-4">üç™</div>
      <h2 class="text-2xl font-bold mb-2">No orders yet</h2>
      <p class="text-base-content/70 mb-6">Get started by creating your first order</p>
      <%= link_to new_order_path, class: "btn btn-primary gap-2 shadow-lg hover:shadow-xl transition-all hover:scale-105" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
        Create Your First Order
      <% end %>
    </div>
  </div>
<% end %>
